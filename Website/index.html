<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title>Tourganiser</title>
		<link rel="stylesheet" href="src/css/styles.css" />
		<link rel="stylesheet" href="src/css/home/home.css" />
		<link rel="stylesheet" href="src/css/home/home-features.css" />
		<link rel="stylesheet" href="src/css/login/login.css" />
		<link rel="stylesheet" href="src/css/about/about.css" />
		<link rel="stylesheet" href="src/css/tournaments/tournaments.css" />
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
		<script src="src/js/script.js" defer></script>
	</head>
	<body>
		<header id="header">
			<h1>Tourganiser</h1>
			<nav>
				<ul>
					<a class="nav-links" name="/">Home</a>
					<a class="nav-links" name="/tournaments">Tournaments</a>
					<a class="nav-links" name="/about">About</a>
					<a onclick="openProfile()">Profile</a>
				</ul>
			</nav>
		</header>

		<div id="profileTab" class="profile-tab">
			<button class="profile-close-btn" onclick="closeProfile()">
				&times;
			</button>
			<div class="profile-content">
				<h2>Profile - Username</h2>
				<div class="profile-item no-hover"></div>
				<div class="profile-item">
					<h4>My Tournament</h4>
				</div>
				<div class="profile-item">
					<h4>Friends</h4>
				</div>
				<div class="profile-actions">
					<div class="profile-actions-settings"></div>
					<div class="profile-actions-item" id="gotoLogin">Login</div>
					<div class="profile-actions-item" id="logout">Logout</div>
				</div>
			</div>
		</div>

		<main id="app">
			<!-- Website content will be loaded here -->
		</main>

		<footer id="footer" class="site-footer">
			<div class="footer-content">
				<div class="footer-section">
					<h4>Quick Links</h4>
					<nav>
						<a class="nav-links" name="/">Home</a>
						<a class="nav-links" name="/tournaments">Tournaments</a>
						<a class="nav-links" name="/about">About</a>
					</nav>
				</div>
				<div class="footer-section">
					<h4>Connect With Us</h4>
					<div class="social-links">
						<a href="#"><i class="fab fa-discord"></i> Discord</a>
						<a href="#"><i class="fab fa-github"></i> GitHub</a>
					</div>
				</div>
				<div class="footer-section">
					<h4>Contact</h4>
					<p>Email: info@tourganiser.com</p>
					<p>Support: support@tourganiser.com</p>
				</div>
			</div>
			<div class="footer-bottom">
				<p>&copy; 2024 Tourganiser. All rights reserved.</p>
				<div class="legal-links">
					<a href="#">Privacy Policy</a>
					<a href="#">Terms of Service</a>
				</div>
			</div>
		</footer>
		<script type="module" src="app.js" defer></script>
		<script type="module">
			import { navigateTo } from "./app.js";
			import { logoutUser } from "./src/js/auth.js";

			const links = document.getElementsByClassName("nav-links");

			for (let l of links) {
				l.addEventListener("click", (event) => {
					navigateTo(event, l.name);
				});
			}

			document
				.getElementById("gotoLogin")
				.addEventListener("click", (event) => {
					navigateTo(event, "/login");
				});
			document
				.getElementById("logout")
				.addEventListener("click", async (event) => {
					try {
						const res = await logoutUser();
						// console.log(res);

						if (res.success) {
							document.getElementById("logout").style.display = "none";
							document.getElementById("gotoLogin").style.display = "block";
						} else {
							console.log("Failed to logout");
						}
					} catch (error) {
						console.error(error);
					}
				});

			fetch("http://localhost:5000/api/check-login")
				.then((response) => {
					if (!response.ok) {
						return response.json().then((errorData) => {
							throw new Error(errorData.message || "Something went wrong");
						});
					}
				})
				.then((data) => {
					if (data.loggedIn) {
						document.getElementById("gotoLogin").style.display = "none";
					} else {
						document.getElementById("logout").style.display = "none";
					}
				})
				.catch((error) => {
					console.log(error);
				});
		</script>
	</body>
</html>
